<?php
include('..'.DIRECTORY_SEPARATOR.'..'.DIRECTORY_SEPARATOR.'..'.DIRECTORY_SEPARATOR.'core'.DIRECTORY_SEPARATOR.'config'.DIRECTORY_SEPARATOR.'config.php');
error_reporting(ERROR_STATE);
header('Content-type:text/html;charset=utf-8');
date_default_timezone_set('Asia/chongqing');
include('..'.D.'..'.D.'..'.D.'core'.D.'config'.D.'config_swoole.php');
include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Connect_mysql.php');
include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Connect_redis.php');
//动态加载swoole服务器类库
function autoload(){
    include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Tcp_server.php');
    include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Udp_server.php');
    include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Http_server.php');
    include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Websocket_server.php');
    include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Rpc_server.php');
    include('..'.D.'..'.D.'..'.D.'core'.D.'static'.D.'Process.php');
}
spl_autoload_register('autoload');

use core\static_formwork\Connect_mysql\Connect_mysql as Connect_mysql;
//加载mysql连接类库
$mysql_conn = Connect_mysql::get();

use core\static_formwork\Connect_redis\Connect_redis as Connect_redis;
//加载redis连接类库,默认不加载,请在config.php中配置是否加载;
if(REDIS_INCLUDE==1){
    $redis = Connect_redis::get();
}

$db = ['mysql'=>$mysql_conn,'redis'=>$redis];
